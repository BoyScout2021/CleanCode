# 3장 함수

## 읽기 힘든 함수란?

* 추상화 수준이 너무 다양하다.
* 코드가 길다.
* 여러개의 중첩된 if문이 있다.



## 읽기 쉬운 함수란?

* 함수는 작으면 작을수록 좋다. - 각 함수가 하는 일이 매우 명백해야한다.
* 한 가지 역할만 해야한다.

### 내려가기 규칙

* 코드는 위에서 아래로 이야기처럼 읽혀야 한다.
* 함수 다음에는 추상화된 수준이 한단계 낮은(기능이 어느정도 구현이 된) 함수가 온다.

<br>

### Switch 문

* Switch 문은 N가지를 처리하도록 만들어짐.
* 이 switch 문을 피할 방법은 없지만, 다형성을 활용해 숨길 수 있다.(프로토콜을 사용해 필수 기능을 명세하자.)

<br>

### 서술적인 이름 사용

* 함수가 작고 단순할수록 서술적인 이름을 고르기 쉬워짐 -> 반대로 함수 네이밍을 하기 힘들다면 단순하고 서술적인게 아닌가
* 함수 기능을 잘 표현하는 이름을 선택하면, 설계가 뚜렷해지므로 나중에 개발자가 코드를 개선하기 더 쉬워진다.

<br>

### 함수 인수

* 인수가 적으면 적을수록 좋다. 가장 이상적인건 0개이다. - 인수가 많을수록 분석해야할 시간이 늘어남.
* 테스트 관점에서도 마찬가지이다. - 테스트를 위해 모든 조합을 검증해야 함.
* 함수 이름은 동사, 함수 인수는 명사가 잘 읽힌다. `writeField(name)`

#### 단항 함수

* 이벤트 형식 - 매개변수만 있고 반환값이 없다.
* 프로그램은 함수 호출을 이벤트로 해석해 매개변수로 시스템 상태를 바꾼다. - 따라서 이름과 문맥을 꼭 유추할 수 있도록 만들자.
* 이런 경우가 아니라면 꼭 반환 함수 형식을 따르자.

#### 플래그 인수

* 넘기지말자. 차라리 메소드를 두개로 만들자?

#### 이항 함수

* `writeField(name)` vs `writeField(outputStream, name)` 전자가 더 쉽게 읽히고 빨리 이해된다.
* outputStream을 꼭 사용해야한다면 `outputStream.writeField(name)` 이렇게 만들 수 있다.

> 근데 CGPoint는 인수를 두개 받지않나요?
>
> * ㅇㅇ 맞는데, 결국 하나의 좌표를 뜻하는거라 ㄱㅊ

#### 인수 객체

* 인수가 2 ~ 3개 필요하다면, 구조체로 만들어 하나의 인수를 사용하는 방법을 생각해보자.

<br>

### 부수 효과를 일으키지 마라

* 함수에서 한 가지를 하겠다고 약속하고 몰래 다른 일을 하는 행위이다. - 예측 불가능하다.

``` swift
func checkPassword(name: String, password: String) -> Bool {
  	let user = UserGateway.findByName(userName)
  	if let user = user {
    		// do someting...
    		let phrase = decrypt()
    		if "Valid Password" == phrase {
      			Session.initialize()
      			return true
    		}
  	}
  
  	return false
}
```

* 여기서 `Session.initialize()` 메소드를 실행하면 안되고, 반환값의 결과로 수행하는 것이 맞는 듯.
* 이게 왜 문제냐면, 비밀번호를 초기화 했을 뿐인데, 세션이 초기화가 됨. 즉 이 메소드를 사용하려면 한가지 조건이 더 붙음. - 세션이 초기화 되어도 괜찮을 때만 사용 가능하도록.

<br>

### 명령과 조회를 분리하라

* 조회: `contains(forKey key: String) -> Bool`
* 명령: `set(_ name: String, forKey key: String)`
* 이런 흐름으로 분리해라. 한번에 하지말고.

<br>

### 오류 코드보다 예외를 사용하라

* 무수히 많은 if 문의 오류코드 분기를 통해 메소드를 작성하면 더러워짐.
* try catch 문으로 해결 가능하다.

<br>

### 그래서 함수를 어떻게 짜죠?

* 글짓기와 비슷하다. 초안 작성 -> 수정을 원하는 문장이 나올 때 까지 반복
* 즉 처음에는 길고 복잡한 메소드를 작성해도 된다. 다만 모든 케이스를 통과하는 테스트 코드만 만들어 놓자.
* 코드를 다듬고, 함수를 만들고, 이름을 바꾸고, 중복을 제거한다. 모든 동작을 수행할 때마다 테스트를 돌려 코드가 제대로 작동하나 검증하자.