# 함수

## 함수란?

- 프로그램에서 가장 기본적인 단위

## 작게 만들기

- 조건문, 반복문 내부 코드블록의 코드는 한줄로
- 들여쓰기 깊이는 최대 2단계까지만

## 한가지 역할만

- 의미를 유지하면서 추상화 수준을 높여 함수로 분리
- 한가지만 하는지 판단하는 기준?
  - 단순히 다른 표현이 아니라, 의미 있는 이름으로 다른 함수를 추출할 수 있을 때
  - 함수 내부 코드에서 동작이 각각의 섹션으로 구분이 될 때

## 하나의 추상화 수준

- 한 함수 내에 여러가지 추상화 수준의 코드가 섞여있다면 가독성이 떨어짐
  - 특정 표현이 근본적인 개념인지 세부사항인지 구분이 어려움
  - 추후 유지보수에도 추상화 수준을 신경쓰지 않고 코드를 막 추가하게 됨
- 내려가기 규칙?
  - 위에서 아래로 프로그램을 읽으면 함수 추상화 수준이 한 단계씩 낮아져야 함
  - private 메서드는 아래로, 외부로 드러나는 메서드는 위로?
    - 보통 외부로 드러나는 메서드가 추상화 수준이 높기 때문
    - 호출 순서대로?

## Switch 문

- Switch 문은 작게 만들기 어려움
- 한 가지 작업만 하는 Switch 문도 만들기 어려움
  - SRP 위반
- 로직 수정에 따른 변경이 잦아짐
  - OCP 위반
- 추상 팩토리 패턴을 활용해 Switch 문을 로직과 분리하여 객체 생성부로 이동
- 추상 팩토리와 같은 다형적 객체 생성 코드나 꼭 필요한 상황을 제외하면 사용하지 않도록

## 서술적인 이름

- 코드를 읽으면서 짐작했던 기능을 각 루틴이 그대로 수행한다면 깨끗한 코드
- 함수가 작고 단순할수록 서술적인 이름을 고르기도 쉬워짐
- 길고 서술적인 이름이 짧고 어려운 이름보다 좋음
- 일관성있는 문체로 이름 짓기

## 함수 인수

- 함수 인수 개수는 적을수록 좋다??
- 인수는 함수의 의미를 이해하기 어렵게 만든다??
  - Swift에선 argument label 로 의미 부여가 가능하여 해당되지 않는듯?
  - 인스턴스 변수로 선언하는 대신 함수 인수로 넘기는 순수함수로 구현하는 것이 더 testable 하지 않은가?
- 플래그 인수 사용하지 않기
  - 플래그 인수를 가진다는 것 자체가 2가지 이상의 역할을 한다는 것
  - 두개의 함수로 나누기
- 인수가 너무 많아 argument label 로도 의미부여가 어렵다면 객체로 만들어 넘기는것도 고려
- 가변인수
  - Swift 5.4에서 여러개의 가변인수를 지원하도록 업데이트 되었으니 사용해볼만한듯?
  - https://github.com/apple/swift-evolution/blob/main/proposals/0284-multiple-variadic-parameters.md

## 사이드이펙트 일으키지 않기

- 가능한 한 최대한 순수함수로 작성하기
- 한가지 역할만 해야한다는 규칙을 위반하고 예상치 못한 동작을 할 가능성이 높아짐
- 만약 사이드이펙트를 가지는 함수라면 함수 이름으로 명확하게 사이드이펙트를 가짐을 표현해주기

## 명령과 조회를 분리?

- 동작과 체킹? 로직을 분리해야 함
- 값 설정 후 확인 함수 -> 값 설정 함수, 확인 함수로 분리

## 에러 쓰로잉 적극 활용하기

- 에러를 나타내는 별도의 코드를 작성하지 말고, 에러 쓰로잉 기능을 활용
- try/catch 구문은 별도 함수로 분리하여 다른 로직엔 드러나지 않도록 하기

## 중복 코드 제거

- 너무 당연한 말..

## 구조적 프로그래밍?

- 모든 함수와 함수 내 모든 블록에 입구와 출구가 하나만 존재해야 한다
- 함수는 return 문이 하나여야 한다?
- 루프 안에서 break나 continue를 사용해선 안된다?

## 함수를 잘 짜는 방법?

1. 처음엔 어떻게든 의도한대로 동작만 하도록 막 짬
2. 해당 로직에 대한 단위 테스트 코드 작성
3. 테스트 통과를 유지하면서 리팩토링

- 처음부터 깔끔하게 잘 짜는 사람은 없다~

## 결론

- 프로그래밍의 목적은 시스템이라는 이야기를 이해하기 쉬운 코드로 풀어가는데 있다는 사실을 명심하고 코드를 짜자
- 이를 위해선 작성된 함수들이 앞서 얘기한 규칙들을 잘 지키도록 깔끔하게 작성되어야 한다
